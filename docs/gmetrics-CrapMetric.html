<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jan 31, 2015 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>GMetrics - GMetrics - CRAP Metric</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20150131" />
    <meta http-equiv="Content-Language" content="en" />
                  
  </head>
  <body class="composite">
    <div id="banner">
                  <a href="" id="bannerLeft">
                GMetrics
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 31 Jan 2015</span>
                  &nbsp;| <span id="projectVersion">Version: 0.7</span>
                      </div>
            <div class="xright">        
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>General</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Home">Home</a>
            </li>
                  <li class="none">
                          <a href="http://sourceforge.net/projects/gmetrics/files/" class="externalLink" title="Downloads">Downloads</a>
            </li>
                  <li class="none">
                          <a href="apidocs/index.html" title="Javadocs">Javadocs</a>
            </li>
                  <li class="none">
                          <a href="http://sourceforge.net/projects/gmetrics" class="externalLink" title="SourceForge Project">SourceForge Project</a>
            </li>
          </ul>
                       <h5>Running</h5>
                  <ul>
                  <li class="none">
                          <a href="gmetrics-ant-task.html" title="Ant Task Usage">Ant Task Usage</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-other-tools-frameworks.html" title="Other Tools/Frameworks">Other Tools/Frameworks</a>
            </li>
          </ul>
                       <h5>Using</h5>
                  <ul>
                  <li class="none">
                          <a href="gmetrics-creating-metricset.html" title="Creating a MetricSet">Creating a MetricSet</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-DefaultMetricSet.html" title="The Default MetricSet">The Default MetricSet</a>
            </li>
          </ul>
                       <h5>Reports</h5>
                  <ul>
                  <li class="none">
                          <a href="gmetrics-BasicHtmlReportWriter.html" title="BasicHtmlReportWriter">BasicHtmlReportWriter</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-SingleSeriesHtmlReportWriter.html" title="SingleSeriesHtmlReportWriter">SingleSeriesHtmlReportWriter</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-XmlReportWriter.html" title="XmlReportWriter">XmlReportWriter</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-sampleReports.html" title="Sample Reports">Sample Reports</a>
            </li>
          </ul>
                       <h5>Metrics</h5>
                  <ul>
                  <li class="none">
                          <a href="gmetrics-AbcMetric.html" title="ABC">ABC</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-AfferentCouplingMetric.html" title="AfferentCoupling">AfferentCoupling</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-ClassCountMetric.html" title="ClassCount">ClassCount</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-ClassLineCountMetric.html" title="ClassLineCount">ClassLineCount</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-CoberturaBranchCoverageMetric.html" title="CoberturaBranchCoverageMetric">CoberturaBranchCoverageMetric</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-CoberturaLineCoverageMetric.html" title="CoberturaLineCoverageMetric">CoberturaLineCoverageMetric</a>
            </li>
                  <li class="none">
            <strong>CrapMetric</strong>
          </li>
                  <li class="none">
                          <a href="gmetrics-CyclomaticComplexityMetric.html" title="CyclomaticComplexity">CyclomaticComplexity</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-EfferentCouplingMetric.html" title="EfferentCoupling">EfferentCoupling</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-FieldCountMetric.html" title="FieldCount">FieldCount</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-MethodLineCountMetric.html" title="MethodLineCount">MethodLineCount</a>
            </li>
                  <li class="none">
                          <a href="gmetrics-MethodCountMetric.html" title="MethodCount">MethodCount</a>
            </li>
          </ul>
                                                                                                                   <a href="http://sourceforge.net" title="Hosted on SourceForge.net" class="poweredBy">
        <img class="poweredBy"  alt="Hosted on SourceForge.net" src="http://sflogo.sourceforge.net/sflogo.php?group_id=208647&type=2"    />
      </a>
                                                                                                          <a href="http://maven.apache.org" title="Build with Maven 2" class="poweredBy">
        <img class="poweredBy"  alt="Build with Maven 2" src="images/logos/maven-feather.png"    />
      </a>
                       
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>CRAP Metric<a name="CRAP_Metric"></a></h2><!-- ~~~~~~~~~~ --><p>Measures the <a class="externalLink" href="http://www.artima.com/weblogs/viewpost.jsp?thread=210575">C.R.A.P.</a> (Change Risk Anti-Patterns) score. It is designed to analyze and predict the amount of effort, pain, and time required to maintain an existing body of code.</p><p>A method with a <b>CRAP score</b> over <b>30</b> is considered <i>CRAPpy</i> (i.e., <i>unacceptable</i>, <i>offensive</i>, etc.). [2]</p><p>Implemented by the <tt>org.gmetrics.metric.crap.CrapMetric</tt> class.</p><div class="section"><h3>CRAP Formula<a name="CRAP_Formula"></a></h3><!-- ~~~~~~~~~~~~~ --><p>Given a Groovy method m, C.R.A.P. for m is calculated as follows:</p><div class="source"><pre>  C.R.A.P.(m) = comp(m)^2 * (1 &#x2013; cov(m)/100)^3 + comp(m)
</pre></div><p>Where <b>comp(m)</b> is the <i>cyclomatic complexity</i> of method m, and <b>cov(m)</b> is the test code coverage provided by automated tests.</p></div><div class="section"><h3>Metric Properties<a name="Metric_Properties"></a></h3><!-- ~~~~~~~~~~~~~~~~~ --><p>The following properties can be configured for this metric within a <i>MetricSet</i>. See <a href="./gmetrics-creating-metricset.html">Creating a MetricSet</a> for information on the syntax of setting a metric property.</p><table border="1" class="bodyTable"><tr class="a"><td align="left"><b>Property</b></td><td align="left"><b>Description</b></td><td align="left"><b>Default Value</b></td></tr><tr class="b"><td align="left">enabled</td><td align="left">This <tt>boolean</tt> property controls whether the metric is <i>enabled</i>. If set to <tt>false</tt>, then the metric is not included as part of the results or the output reports.</td><td align="left"><tt>true</tt></td></tr><tr class="a"><td align="left">functions</td><td align="left">This <tt>List&lt;String&gt;</tt> property contains the names of the functions to be calculated at the <i>class</i> and <i>package</i> levels and (potentially) included within the report(s). Valid values are: - &quot;total&quot; - &quot;average&quot; - &quot;minimum&quot; - &quot;maximum&quot;</td><td align="left"><tt>[&quot;total&quot;,&quot;average&quot;]</tt></td></tr><tr class="b"><td align="left">coverageMetric</td><td align="left">The <b>GMetrics</b> <i>Metric</i> instance to provide code coverage data. <b>GMetrics</b> includes a <i>Cobertura</i>-based coverage metric. See <a href="./gmetrics-CoberturaLineCoverageMetric.html">CoberturaLineCoverageMetric</a> This property is REQUIRED.</td><td align="left"><i>N/A</i></td></tr><tr class="a"><td align="left">complexityMetric</td><td align="left">The <b>GMetrics</b> <i>Metric</i> instance to provide <i>cyclomatic complexity</i> data. <b>GMetrics</b> includes a <a href="./gmetrics-CyclomaticComplexityMetric.html">CyclomaticComplexityMetric</a>, which is used as the default provider.</td><td align="left">An instance of <a href="./gmetrics-CyclomaticComplexityMetric.html">CyclomaticComplexityMetric</a></td></tr></table></div><div class="section"><h3>Sample MetricSet Definition<a name="Sample_MetricSet_Definition"></a></h3><!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ --><p>Here is a sample <i>MetricSet</i> definition that includes a <b>CrapMetric</b>.</p><div class="source"><pre>  final COBERTURA_FILE = 'coverage/GMetrics/coverage.xml'

  metricset {

      def coberturaMetric = CoberturaLineCoverage {
          coberturaFile = COBERTURA_FILE
          functions = ['total']
      }

      CRAP {
          functions = ['total']
          coverageMetric = coberturaMetric
    }
  }
</pre></div><p>Note setting the <i>coverageMetric</i> field is required.</p><p>The <b>CRAP</b> metric is a special <i>composite</i> metric -- it uses other metrics to calculate complexity and code coverage. In the example above, the <b>CoberturaLineCoverage</b> metric is also included within the <i>MetricSet</i> being defined. Alternatively, if you define the <b>CoberturaLineCoverage</b> metric <i>within</i> the <b>CRAP</b> metric definition, then the <b>CoberturaLineCoverage</b> metric is not included within the <i>MetricSet</i>, as in the example below.</p><div class="source"><pre>  final COBERTURA_FILE = 'coverage/GMetrics/coverage.xml'

  metricset {

      CRAP {
          // CoberturaLineCoverage is not included in the MetricSet
          coverageMetric = CoberturaLineCoverage {
              coberturaFile = COBERTURA_FILE
          }
    }
  }
</pre></div><p>There is one annoying <i>known limitation</i> with that behavior. If you use the <i>Map</i> syntax, rather than the <i>Closure</i> syntax, to define the outer metric, then inner metric is also included within the <i>MetricSet</i>, as in the example below.</p><div class="source"><pre>  metricset {
      // Both CRAP and CoberturaLineCoverage metrics are included in the MetricSet
      CRAP(coverageMetric:CoberturaLineCoverage(coberturaFile:'coverage/GMetrics/coverage.xml'))
  }
</pre></div></div><div class="section"><h3>References<a name="References"></a></h3><!-- ~~~~~~~~~~ --><ul><li><b>[1]</b> The original 2007 <a class="externalLink" href="http://www.artima.com/weblogs/viewpost.jsp?thread=210575">blog post</a> that defined the <b>CRAP</b> metric.</li><li><b>[2]</b> A 2011 <a class="externalLink" href="http://googletesting.blogspot.com/2011/02/this-code-is-crap.html">blog post</a> from Alberto Savoia (the co-creator of the <b>CRAP</b> metric with Bob Evans), describing the formula, the motivation, and the <b>CRAP4J</b> tool for calculating <b>CRAP</b> score for Java code.</li></ul></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">Copyright &#169;                   2015.
          All Rights Reserved.      
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
